---
import { getPostTeasers } from '../sanity/queries';
import PageLayout from 'components/layout/PageLayout.astro';
import { Heading, PostTeaser, Text } from 'components/shared';

const posts = await getPostTeasers();
---

<PageLayout>
  <div class="container mb:8 md:mb-12 lg:mb-16">
    <Heading class:list={['mb-8']} as="h1">Welcome to Manhole Gallery</Heading>
    <div class="max-w-prose">
      <Text size="lg">
        Pavement Chronicles Unveiled - Unearth street art beneath your feet from
        all <em>around</em> the flat earth.
      </Text>
    </div>
  </div>

  <div
    class="grid xs:grid-cols-2 lg:grid-cols-3 flex-1 align-top justify-start gap-4 max-w-[125rem] mx-auto"
  >
    {posts.map((post, index) => <PostTeaser post={post} lazy={index >= 6} />)}
    {
      posts.length % 3 !== 0 && (
        <div class="hidden align-middle justify-center flex-col border-2 border-dashed border-black/30 dark:border-white/30 col-span-[-1] text-center teaser-placeholder space-y-4">
          <Heading as="p" size="h3">
            Feel free to contribute
          </Heading>
          <p>
            <a href="mailto:callum@wrux.com" class="button">
              Message Me
            </a>
          </p>
        </div>
      )
    }
  </div>
</PageLayout>

<style>
  .teaser-placeholder:nth-child(3n):nth-last-of-type(1) {
    @screen xs {
      display: flex;
    }
  }

  .teaser-placeholder:nth-child(3n-1):nth-last-of-type(1) {
    grid-column: span 1;

    @screen xs {
      display: flex;
    }

    @screen lg {
      grid-column: span 2;
    }
  }

  .teaser-placeholder:nth-child(3n-2):nth-last-of-type(1) {
    grid-column: span 3;

    @screen xs {
      display: flex;
    }
  }
</style>
